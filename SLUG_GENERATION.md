# Генерация Slug для Продуктов

## Обзор

Система автоматически генерирует уникальные slug для продуктов на основе их заголовков. Slug используется для создания SEO-friendly URL и уникальной идентификации продуктов.

## Как это работает

### 1. Автоматическая генерация при создании

При создании нового продукта система автоматически генерирует slug из заголовка:

```javascript
// Пример: "iPhone 15 Pro Max" -> "iphone-15-pro-max"
```

### 2. Автоматическое обновление при изменении заголовка

При обновлении заголовка продукта slug автоматически перегенерируется:

```javascript
// Если заголовок изменился с "iPhone 15 Pro Max" на "iPhone 15 Pro Max 256GB"
// slug изменится с "iphone-15-pro-max" на "iphone-15-pro-max-256gb"
```

### 3. Обеспечение уникальности

Если slug уже существует, система добавляет числовой суффикс:

```javascript
// "Tank" -> "tank"
// "Tank" -> "tank-1"
// "Tank" -> "tank-2"
```

Это работает независимо от того, кто создает продукт - разные продавцы или один продавец создает несколько продуктов с одинаковым названием.

## Правила генерации slug

1. **Приведение к нижнему регистру**: Все символы преобразуются в нижний регистр
2. **Удаление специальных символов**: Все символы кроме букв, цифр и пробелов удаляются
3. **Замена пробелов**: Пробелы заменяются на дефисы
4. **Удаление множественных дефисов**: Подряд идущие дефисы заменяются одним
5. **Удаление дефисов в начале и конце**: Дефисы в начале и конце строки удаляются

## Примеры преобразований

| Заголовок | Slug |
|-----------|------|
| "iPhone 15 Pro Max" | "iphone-15-pro-max" |
| "Samsung Galaxy S24 Ultra" | "samsung-galaxy-s24-ultra" |
| "MacBook Pro 16-inch" | "macbook-pro-16-inch" |
| "AirPods Pro (2nd generation)" | "airpods-pro-2nd-generation" |
| "iPad Pro 12.9-inch" | "ipad-pro-129-inch" |
| "Apple Watch Series 9" | "apple-watch-series-9" |

## Решение проблемы дублирования

В marketplace часто бывает, что разные продавцы создают продукты с одинаковыми названиями. Наша система решает эту проблему автоматически:

### Пример с продуктом "Tank":

1. **Первый продавец** создает продукт "Tank" → slug: `tank`
2. **Второй продавец** создает продукт "Tank" → slug: `tank-1`
3. **Третий продавец** создает продукт "Tank" → slug: `tank-2`

### Преимущества такого подхода:

- ✅ **Уникальность**: Каждый продукт имеет уникальный slug
- ✅ **Читаемость**: Первый продукт имеет чистый slug без цифр
- ✅ **SEO-friendly**: URL остаются понятными и краткими
- ✅ **Автоматичность**: Не требует ручного вмешательства

## Использование в API

### Создание продукта

```javascript
// POST /api/products
{
  "data": {
    "title": "iPhone 15 Pro Max",
    "price": 999.99,
    "category": 1,
    "description": "Latest iPhone model"
    // slug будет сгенерирован автоматически
  }
}
```

### Обновление продукта

```javascript
// PUT /api/products/:id
{
  "data": {
    "title": "iPhone 15 Pro Max 256GB"
    // slug будет перегенерирован автоматически
  }
}
```

## Файлы

- `src/utils/slug.ts` - Утилита для генерации slug
- `src/api/product/controllers/product.ts` - Контроллер с логикой генерации
- `src/api/product/content-types/product/schema.json` - Схема продукта

## Тестирование

Для тестирования генерации slug используйте:

```bash
node test-slug-simple.js
```

Этот скрипт покажет примеры преобразования различных заголовков в slug.
